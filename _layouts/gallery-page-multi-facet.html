---
layout: default
---

{%- assign the_collection = site[page.collection] -%}
{% assign num = the_collection | size %}

<div><p>{{ page.welcome }}</p></div>

<div id='wax-gallery-{{ page.collection }}-container' class='wax-gallery-container full-width'>
  <div class='wax-inline-container'>
    {% for facet in page.facet_by %}
    <div id="{{ page.collection }}-{{ facet }}-buttons" class="facet-buttons"></div>
    {% endfor %}
    <div id="count"><span>{{ num }}</span>&nbsp;proposals selected</div>
    <hr/>
    <div id="wax-gallery-{{ page.collection }}" class="wax-gallery"></div>
    </div>
</div>

<script type="text/javascript">
  $( document ).ready(function() {
    var container = $('#wax-gallery-{{ page.collection }}-container');
    var gallery = $('#wax-gallery-{{ page.collection }}');

    {% for item in the_collection %}
      {%- capture item_html -%}
        "<div id={{ item.pid }} class='gallery-item all'><a href='{{ site.baseurl }}/{{ page.collection }}/{{ item.pid }}/'><div class='hovereffect'><img class='img-responsive gallery-thumb' src='{{ item.thumbnail | absolute_url }}' alt='{{ item.label }}'/><div class='overlay'><p class='info'>{{ item.label }}</p></div></div></a></div>"
      {%- endcapture -%}
      gallery.append({{ item_html | strip_newlines }});
    {% endfor %}

    {% if page.facet_by %}
      {% for facet in page.facet_by %}
        var buttonDiv = $('#{{ page.collection }}-{{ facet }}-buttons');

        var facets = Array.from(new Set([{%- for item in the_collection -%}'{{ item[facet] | slugify }}'{% unless forloop.last %}, {% endunless %}{%- endfor -%}]));
        buttonDiv.append("<button class='btn facet active' data-filter='all'>show all</button>");

        for (i in facets) {
          buttonDiv.append(`<button class='btn facet' data-filter='${facets[i]}'>${facets[i]}</button>`);
        }

        {% for item in the_collection %}
        var element = document.getElementById("{{ item.pid }}");
          element.classList.add("{{ item[facet] | slugify }}");
        {% endfor %}

        //add a class to each gallery item for the items' facet value
      {% endfor %}

      $(document).ready(function(){
          $(".facet").click(function(){
            var filterValue = $(this).attr('data-filter');
            $('.facet').removeClass('active');
            $(this).addClass('active');
            if(filterValue == 'all') { $('.all').show('slow'); }
            else { $('.all').hide('slow'); $(`.${filterValue}`).show('slow'); }
          });
        });

      //add filter code, update number of results
    {% endif %}
  });
</script>
